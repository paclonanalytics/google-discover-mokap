import DashboardLayout from "@/components/DashboardLayout";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from "@/components/ui/tooltip";
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";
import { Clock, TrendingUp, Hash, BarChart3, Calendar } from "lucide-react";
import { useState } from "react";

// Mock data - Extended to 10 items
const popularMaterials = [
  {
    id: 1,
    image: "https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?w=120&h=80&fit=crop",
    title: "Новые технологии искусственного интеллекта меняют индустрию разработки",
    publishedDate: "13 ноября 2025",
    format: "Article",
    domain: "techcrunch.com",
    favicon: "https://techcrunch.com/favicon.ico",
    dds: 87,
    avgPosition: 2.3,
    entities: ["AI", "Machine Learning", "Technology", "Innovation"],
    category: "Technology",
    lifetime: "18h",
    estTraffic: "125K",
  },
  {
    id: 2,
    image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=120&h=80&fit=crop",
    title: "Анализ рынка криптовалют: что ждет инвесторов в 2025 году",
    publishedDate: "12 ноября 2025",
    format: "Analysis",
    domain: "bloomberg.com",
    favicon: "https://bloomberg.com/favicon.ico",
    dds: 92,
    avgPosition: 1.8,
    entities: ["Cryptocurrency", "Bitcoin", "Finance", "Investment"],
    category: "Finance",
    lifetime: "12h",
    estTraffic: "98K",
  },
  {
    id: 3,
    image: "https://images.unsplash.com/photo-1526256262350-7da7584cf5eb?w=120&h=80&fit=crop",
    title: "Здоровый образ жизни: 10 привычек успешных людей",
    publishedDate: "13 ноября 2025",
    format: "Listicle",
    domain: "healthline.com",
    favicon: "https://healthline.com/favicon.ico",
    dds: 75,
    avgPosition: 3.5,
    entities: ["Health", "Lifestyle", "Wellness", "Habits"],
    category: "Health",
    lifetime: "24h",
    estTraffic: "156K",
  },
  {
    id: 4,
    image: "https://images.unsplash.com/photo-1461749280684-dccba630e2f6?w=120&h=80&fit=crop",
    title: "Революция в программировании: новый язык от Google",
    publishedDate: "12 ноября 2025",
    format: "Article",
    domain: "wired.com",
    favicon: "https://wired.com/favicon.ico",
    dds: 88,
    avgPosition: 2.1,
    entities: ["Programming", "Google", "Software", "Development"],
    category: "Technology",
    lifetime: "16h",
    estTraffic: "142K",
  },
  {
    id: 5,
    image: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=120&h=80&fit=crop",
    title: "Стратегии инвестирования в нестабильное время",
    publishedDate: "11 ноября 2025",
    format: "Analysis",
    domain: "forbes.com",
    favicon: "https://forbes.com/favicon.ico",
    dds: 90,
    avgPosition: 1.5,
    entities: ["Investment", "Strategy", "Economy", "Finance"],
    category: "Finance",
    lifetime: "20h",
    estTraffic: "187K",
  },
  {
    id: 6,
    image: "https://images.unsplash.com/photo-1505751172876-fa1923c5c528?w=120&h=80&fit=crop",
    title: "Питание для продуктивности: что есть для максимальной энергии",
    publishedDate: "13 ноября 2025",
    format: "Article",
    domain: "medicalnewstoday.com",
    favicon: "https://medicalnewstoday.com/favicon.ico",
    dds: 78,
    avgPosition: 4.2,
    entities: ["Nutrition", "Productivity", "Energy", "Food"],
    category: "Health",
    lifetime: "22h",
    estTraffic: "134K",
  },
  {
    id: 7,
    image: "https://images.unsplash.com/photo-1518770660439-4636190af475?w=120&h=80&fit=crop",
    title: "Будущее облачных технологий: тренды 2025",
    publishedDate: "12 ноября 2025",
    format: "Analysis",
    domain: "techradar.com",
    favicon: "https://techradar.com/favicon.ico",
    dds: 85,
    avgPosition: 2.7,
    entities: ["Cloud", "Technology", "Innovation", "Trends"],
    category: "Technology",
    lifetime: "14h",
    estTraffic: "119K",
  },
  {
    id: 8,
    image: "https://images.unsplash.com/photo-1579621970563-ebec7560ff3e?w=120&h=80&fit=crop",
    title: "Психология успеха: как мыслят миллионеры",
    publishedDate: "11 ноября 2025",
    format: "Article",
    domain: "entrepreneur.com",
    favicon: "https://entrepreneur.com/favicon.ico",
    dds: 82,
    avgPosition: 3.1,
    entities: ["Psychology", "Success", "Business", "Mindset"],
    category: "Business",
    lifetime: "19h",
    estTraffic: "165K",
  },
  {
    id: 9,
    image: "https://images.unsplash.com/photo-1551434678-e076c223a692?w=120&h=80&fit=crop",
    title: "Agile vs Waterfall: какую методологию выбрать в 2025",
    publishedDate: "13 ноября 2025",
    format: "Comparison",
    domain: "atlassian.com",
    favicon: "https://atlassian.com/favicon.ico",
    dds: 86,
    avgPosition: 2.9,
    entities: ["Agile", "Project Management", "Software", "Methodology"],
    category: "Technology",
    lifetime: "15h",
    estTraffic: "128K",
  },
  {
    id: 10,
    image: "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?w=120&h=80&fit=crop",
    title: "Лидерство в цифровую эпоху: навыки будущего",
    publishedDate: "12 ноября 2025",
    format: "Article",
    domain: "hbr.org",
    favicon: "https://hbr.org/favicon.ico",
    dds: 91,
    avgPosition: 1.9,
    entities: ["Leadership", "Digital", "Management", "Skills"],
    category: "Business",
    lifetime: "17h",
    estTraffic: "173K",
  },
];

const popularEntities = [
  { name: "Artificial Intelligence", count: 1247, trend: "+15%", sparkline: [85, 88, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135] },
  { name: "Climate Change", count: 982, trend: "+8%", sparkline: [75, 77, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96] },
  { name: "Electric Vehicles", count: 876, trend: "+22%", sparkline: [60, 65, 70, 75, 82, 90, 98, 105, 112, 120, 128, 136] },
  { name: "Cryptocurrency", count: 754, trend: "-5%", sparkline: [95, 92, 88, 85, 82, 78, 75, 72, 68, 65, 62, 60] },
  { name: "Space Exploration", count: 623, trend: "+12%", sparkline: [45, 48, 50, 53, 56, 59, 62, 65, 68, 71, 74, 77] },
];

const popularCategories = [
  { name: "Technology", count: 2847, trend: "+18%", color: "from-blue-500 to-cyan-500", sparkline: [180, 190, 200, 210, 220, 235, 250, 265, 280, 295, 310, 325] },
  { name: "Finance", count: 1923, trend: "+12%", color: "from-green-500 to-emerald-500", sparkline: [140, 145, 150, 155, 160, 165, 170, 175, 180, 185, 190, 195] },
  { name: "Health", count: 1654, trend: "+9%", color: "from-pink-500 to-rose-500", sparkline: [120, 125, 128, 132, 136, 140, 144, 148, 152, 156, 160, 164] },
  { name: "Business", count: 1432, trend: "+15%", color: "from-purple-500 to-violet-500", sparkline: [100, 105, 110, 115, 122, 130, 138, 146, 154, 162, 170, 178] },
  { name: "Science", count: 987, trend: "+6%", color: "from-orange-500 to-amber-500", sparkline: [80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102] },
];

const popularStories = [
  { title: "Прорыв в квантовых вычислениях", mentions: 342, sources: 28 },
  { title: "Новая климатическая политика ЕС", mentions: 289, sources: 45 },
  { title: "Запуск нового iPhone 16", mentions: 267, sources: 52 },
  { title: "Выборы президента США 2024", mentions: 234, sources: 67 },
];

const popularDomains = [
  { domain: "nytimes.com", articles: 156, dds: 95, trend: "+18%", favicon: "https://nytimes.com/favicon.ico", sparkline: [12, 15, 14, 18, 16, 20, 19, 22, 21, 24, 23, 26] },
  { domain: "bbc.com", articles: 143, dds: 93, trend: "+15%", favicon: "https://bbc.com/favicon.ico", sparkline: [10, 12, 11, 14, 13, 16, 15, 18, 17, 20, 19, 22] },
  { domain: "cnn.com", articles: 128, dds: 89, trend: "+12%", favicon: "https://cnn.com/favicon.ico", sparkline: [8, 10, 9, 12, 11, 14, 13, 16, 15, 18, 17, 20] },
  { domain: "theguardian.com", articles: 112, dds: 91, trend: "+14%", favicon: "https://theguardian.com/favicon.ico", sparkline: [9, 11, 10, 13, 12, 15, 14, 17, 16, 19, 18, 21] },
  { domain: "reuters.com", articles: 105, dds: 88, trend: "+10%", favicon: "https://reuters.com/favicon.ico", sparkline: [7, 9, 8, 11, 10, 13, 12, 15, 14, 17, 16, 19] },
];

const searchHistory = [
  { query: "Technology, USA, Live", timestamp: "2 часа назад" },
  { query: "Finance, Global, Last 24h", timestamp: "5 часов назад" },
  { query: "Health, Europe, Last Week", timestamp: "1 день назад" },
];

export default function Home() {
  const [period, setPeriod] = useState("live");

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        {/* Search Form with Simplified Filters */}
        <Card className="border border-border shadow-sm">
          <CardContent className="py-4">
            {/* Header and Filters in One Row */}
            <div className="flex items-center justify-between">
              {/* Left: Title Only */}
              <h2 className="text-3xl font-bold text-foreground">
                Discover Overview
              </h2>

              {/* Right: Filters without labels */}
              <div className="flex items-center gap-2">
                <Select defaultValue="usa">
                  <SelectTrigger className="h-9 text-sm w-[130px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="usa">США</SelectItem>
                    <SelectItem value="russia">Россия</SelectItem>
                    <SelectItem value="uk">Великобритания</SelectItem>
                    <SelectItem value="germany">Германия</SelectItem>
                    <SelectItem value="france">Франция</SelectItem>
                  </SelectContent>
                </Select>

                <Select defaultValue="en">
                  <SelectTrigger className="h-9 text-sm w-[120px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="en">English</SelectItem>
                    <SelectItem value="ru">Русский</SelectItem>
                    <SelectItem value="de">Deutsch</SelectItem>
                    <SelectItem value="fr">Français</SelectItem>
                    <SelectItem value="es">Español</SelectItem>
                  </SelectContent>
                </Select>

                <Select defaultValue="all">
                  <SelectTrigger className="h-9 text-sm w-[140px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Все категории</SelectItem>
                    <SelectItem value="technology">Технологии</SelectItem>
                    <SelectItem value="finance">Финансы</SelectItem>
                    <SelectItem value="health">Здоровье</SelectItem>
                    <SelectItem value="sports">Спорт</SelectItem>
                    <SelectItem value="entertainment">Развлечения</SelectItem>
                  </SelectContent>
                </Select>

                <Select defaultValue="all">
                  <SelectTrigger className="h-9 text-sm w-[130px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Все форматы</SelectItem>
                    <SelectItem value="article">Статья</SelectItem>
                    <SelectItem value="video">Видео</SelectItem>
                    <SelectItem value="listicle">Список</SelectItem>
                    <SelectItem value="analysis">Аналитика</SelectItem>
                  </SelectContent>
                </Select>

                <Select defaultValue="all">
                  <SelectTrigger className="h-9 text-sm w-[110px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">All</SelectItem>
                    <SelectItem value="google">Google</SelectItem>
                    <SelectItem value="mozilla">Mozilla</SelectItem>
                  </SelectContent>
                </Select>

                <Select value={period} onValueChange={setPeriod}>
                  <SelectTrigger className="h-9 text-sm w-[140px]">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="live">
                      <div className="flex items-center gap-2">
                        <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                        Live
                      </div>
                    </SelectItem>
                    <SelectItem value="24h">24 часа</SelectItem>
                    <SelectItem value="week">Неделя</SelectItem>
                    <SelectItem value="month">Месяц</SelectItem>
                    <SelectItem value="custom">
                      <div className="flex items-center gap-2">
                        <Calendar className="w-3 h-3" />
                        Выбрать период
                      </div>
                    </SelectItem>
                  </SelectContent>
                </Select>
                
                {/* Search Button - Semrush green */}
                <Button className="h-9 bg-accent hover:bg-accent/90 text-accent-foreground font-medium px-6">
                  Search
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>

        {/* Popular Materials - Reorganized Table */}
        <Card className="border border-border shadow-sm">
          <CardHeader className="pb-2">
            <CardTitle className="text-base">Popular publications</CardTitle>
          </CardHeader>
          <CardContent className="pt-0">
            <Table>
              <TableHeader>
                <TableRow className="border-b border-border/50">
                  <TableHead className="w-[100px]"></TableHead>
                  <TableHead className="text-xs font-semibold text-muted-foreground uppercase tracking-wide">Заголовок</TableHead>
                  <TableHead className="w-[100px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">Формат</TableHead>
                  <TableHead className="w-[150px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">Паблишер</TableHead>
                  <TableHead className="w-[70px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">
                    <TooltipProvider>
                      <Tooltip>
                        <TooltipTrigger className="cursor-help">DDS</TooltipTrigger>
                        <TooltipContent className="max-w-xs">
                          <p className="text-sm">DDS - Discover Domain Score - показатель видимости домена в Google Discover</p>
                        </TooltipContent>
                      </Tooltip>
                    </TooltipProvider>
                  </TableHead>
                  <TableHead className="w-[200px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">Сущности</TableHead>
                  <TableHead className="w-[120px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">Категория</TableHead>
                  <TableHead className="w-[80px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">
                    <TooltipProvider>
                      <Tooltip>
                        <TooltipTrigger className="cursor-help">Lifetime</TooltipTrigger>
                        <TooltipContent className="max-w-xs">
                          <p className="text-sm">Количество часов наблюдения статьи в Google Discover</p>
                        </TooltipContent>
                      </Tooltip>
                    </TooltipProvider>
                  </TableHead>
                  <TableHead className="w-[90px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">
                    <TooltipProvider>
                      <Tooltip>
                        <TooltipTrigger className="cursor-help">Avg Pos</TooltipTrigger>
                        <TooltipContent className="max-w-xs">
                          <p className="text-sm">Средняя позиция показа статьи в фиде</p>
                        </TooltipContent>
                      </Tooltip>
                    </TooltipProvider>
                  </TableHead>
                  <TableHead className="w-[100px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">
                    <TooltipProvider>
                      <Tooltip>
                        <TooltipTrigger className="cursor-help">Est Traffic</TooltipTrigger>
                        <TooltipContent className="max-w-xs">
                          <p className="text-sm">Прогнозный объем трафика получаемый из Google Discover</p>
                        </TooltipContent>
                      </Tooltip>
                    </TooltipProvider>
                  </TableHead>
                </TableRow>
              </TableHeader>
              <TableBody>
                {popularMaterials.map((material) => (
                  <TableRow key={material.id} className="hover:bg-muted/50 transition-colors border-b border-border/30">
                    <TableCell>
                      <img
                        src={material.image}
                        alt={material.title}
                        className="w-20 h-14 object-cover rounded-lg shadow-sm"
                      />
                    </TableCell>
                    <TableCell>
                      <div className="font-medium text-sm">{material.title}</div>
                      <div className="text-xs text-muted-foreground mt-0.5">
                        {material.publishedDate}
                      </div>
                    </TableCell>
                    <TableCell>
                      <Badge variant="secondary" className="text-xs bg-secondary text-foreground border-0">
                        {material.format}
                      </Badge>
                    </TableCell>
                    <TableCell>
                      <div className="flex items-center gap-1.5">
                        <img
                          src={material.favicon}
                          alt=""
                          className="w-3.5 h-3.5"
                          onError={(e) => {
                            e.currentTarget.style.display = "none";
                          }}
                        />
                        <span className="text-xs font-medium">{material.domain}</span>
                      </div>
                    </TableCell>
                    <TableCell>
                      <Badge variant="secondary" className="text-xs font-semibold bg-primary/10 text-primary border-0">
                        {material.dds}
                      </Badge>
                    </TableCell>
                    <TableCell>
                      <div className="flex flex-wrap gap-1">
                        {material.entities.map((entity, idx) => (
                          <Badge 
                            key={idx} 
                            variant={idx === 0 ? "default" : "outline"}
                            className={`text-[10px] px-1.5 py-0 ${
                              idx === 0 
                                ? "bg-primary text-primary-foreground font-semibold" 
                                : "border-border/50 hover:bg-muted"
                            }`}
                          >
                            {entity}
                          </Badge>
                        ))}
                      </div>
                    </TableCell>
                    <TableCell>
                      <Badge variant="outline" className="text-xs border-border/50 text-muted-foreground">
                        {material.category}
                      </Badge>
                    </TableCell>
                    <TableCell className="text-xs text-muted-foreground">{material.lifetime}</TableCell>
                    <TableCell>
                      <div className="text-xs font-semibold text-foreground">
                        {material.avgPosition}
                      </div>
                    </TableCell>
                    <TableCell>
                      <div className="text-xs font-medium text-foreground">
                        {material.estTraffic}
                      </div>
                    </TableCell>
                  </TableRow>
                ))}
              </TableBody>
            </Table>
          </CardContent>
        </Card>

        {/* Grid Widgets - Three columns */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {/* Popular Entities */}
          <Card className="border border-border shadow-sm">
            <CardHeader className="pb-2">
              <div className="flex items-center justify-between">
                <CardTitle className="text-base">Popular Entities</CardTitle>
                <span className="text-xs text-muted-foreground font-medium">Публикации</span>
              </div>
            </CardHeader>
            <CardContent className="pt-0">
              <div className="space-y-2">
                {popularEntities.map((entity, idx) => (
                  <div
                    key={idx}
                    className="flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer group"
                  >
                    <span className="font-medium text-sm text-foreground flex-1">{entity.name}</span>
                    <div className="flex items-center gap-1">
                      <span className="text-xs text-muted-foreground font-medium w-12 text-right">{entity.count}</span>
                      <svg width="60" height="20" className="opacity-70">
                        {entity.sparkline.map((val, i) => (
                          <rect
                            key={i}
                            x={i * 5}
                            y={20 - (val / Math.max(...entity.sparkline)) * 18}
                            width="3.5"
                            height={(val / Math.max(...entity.sparkline)) * 18}
                            fill="currentColor"
                            className="text-primary"
                          />
                        ))}
                      </svg>
                      <Badge
                        variant="secondary"
                        className={`text-xs w-14 justify-center ${entity.trend.startsWith("+") ? "bg-accent/10 text-accent" : "bg-destructive/10 text-destructive"} border-0`}
                      >
                        {entity.trend}
                      </Badge>
                    </div>
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>

          {/* Popular Categories */}
          <Card className="border border-border shadow-sm">
            <CardHeader className="pb-2">
              <div className="flex items-center justify-between">
                <CardTitle className="text-base">Popular Categories</CardTitle>
                <span className="text-xs text-muted-foreground font-medium">Публикации</span>
              </div>
            </CardHeader>
            <CardContent className="pt-0">
              <div className="space-y-2">
                {popularCategories.map((category, idx) => (
                  <div
                    key={idx}
                    className="flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer group"
                  >
                    <div className="flex items-center gap-2 flex-1">
                      <div className={`w-2 h-2 rounded-full bg-gradient-to-r ${category.color}`}></div>
                      <span className="font-medium text-sm text-foreground group-hover:text-primary transition-colors">{category.name}</span>
                    </div>
                    <div className="flex items-center gap-1">
                      <span className="text-xs text-muted-foreground font-medium w-12 text-right">{category.count}</span>
                      <svg width="60" height="20" className="opacity-70">
                        {category.sparkline.map((val, i) => (
                          <rect
                            key={i}
                            x={i * 5}
                            y={20 - (val / Math.max(...category.sparkline)) * 18}
                            width="3.5"
                            height={(val / Math.max(...category.sparkline)) * 18}
                            fill="currentColor"
                            className="text-primary"
                          />
                        ))}
                      </svg>
                      <Badge
                        variant="secondary"
                        className="text-xs w-14 justify-center bg-accent/10 text-accent border-0"
                      >
                        {category.trend}
                      </Badge>
                    </div>
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>

          {/* Popular Publishers */}
          <Card className="border border-border shadow-sm">
            <CardHeader className="pb-2">
              <div className="flex items-center justify-between">
                <CardTitle className="text-base">Popular Publishers</CardTitle>
                <span className="text-xs text-muted-foreground font-medium">Публикации</span>
              </div>
            </CardHeader>
            <CardContent className="pt-0">
              <div className="space-y-2">
                {popularDomains.map((domain, idx) => (
                  <div
                    key={idx}
                    className="flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer group"
                  >
                    <div className="flex items-center gap-2 flex-1">
                      <img
                        src={domain.favicon}
                        alt=""
                        className="w-4 h-4"
                        onError={(e) => {
                          e.currentTarget.style.display = "none";
                        }}
                      />
                      <span className="font-medium text-sm text-foreground group-hover:text-primary transition-colors">{domain.domain}</span>
                      <div className="relative group/tooltip">
                        <Badge variant="outline" className="text-xs border-primary/30 bg-gradient-to-r from-primary/10 to-accent/10 text-primary font-semibold cursor-help">
                          {domain.dds}
                        </Badge>
                        <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-3 py-2 bg-popover text-popover-foreground text-xs rounded-md shadow-lg border border-border opacity-0 invisible group-hover/tooltip:opacity-100 group-hover/tooltip:visible transition-all duration-200 whitespace-nowrap z-50">
                          DDS - Discover Domain Score<br />
                          показатель видимости домена в Google Discover
                        </div>
                      </div>
                    </div>
                    <div className="flex items-center gap-1">
                      <span className="text-xs text-muted-foreground font-medium w-12 text-right">{domain.articles}</span>
                      <svg width="60" height="20" className="opacity-70">
                        {domain.sparkline.map((val, i) => (
                          <rect
                            key={i}
                            x={i * 5}
                            y={20 - (val / Math.max(...domain.sparkline)) * 18}
                            width="3.5"
                            height={(val / Math.max(...domain.sparkline)) * 18}
                            fill="currentColor"
                            className="text-primary"
                          />
                        ))}
                      </svg>
                      <Badge
                        variant="secondary"
                        className={`text-xs w-14 justify-center ${domain.trend.startsWith("+") ? "bg-accent/10 text-accent" : "bg-destructive/10 text-destructive"} border-0`}
                      >
                        {domain.trend}
                      </Badge>
                    </div>
                  </div>
                ))}
              </div>
            </CardContent>
          </Card>

        </div>

        {/* Search History - Full width */}
        <Card className="border border-border shadow-sm">
            <CardHeader className="pb-2">
              <CardTitle className="text-base">History Searches</CardTitle>
            </CardHeader>
            <CardContent className="pt-0">
              <Table>
                <TableHeader>
                  <TableRow className="border-b border-border/50">
                    <TableHead className="text-xs font-semibold text-muted-foreground uppercase tracking-wide">Query</TableHead>
                    <TableHead className="w-[200px] text-xs font-semibold text-muted-foreground uppercase tracking-wide">Timestamp</TableHead>
                  </TableRow>
                </TableHeader>
                <TableBody>
                  {searchHistory.map((item, idx) => (
                    <TableRow key={idx} className="hover:bg-primary/5 transition-colors cursor-pointer">
                      <TableCell className="font-medium text-sm">{item.query}</TableCell>
                      <TableCell className="text-xs text-muted-foreground">{item.timestamp}</TableCell>
                    </TableRow>
                  ))}
                </TableBody>
              </Table>
            </CardContent>
        </Card>
      </div>
    </DashboardLayout>
  );
}
